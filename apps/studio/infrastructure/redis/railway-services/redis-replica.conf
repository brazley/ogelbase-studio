# Redis Replica Configuration
# Role: Read-only slave, replicates from primary

# Network
bind 0.0.0.0
port 6379
tcp-backlog 511
timeout 0
tcp-keepalive 300

# Security
requirepass ${REDIS_PASSWORD}
masterauth ${REDIS_PASSWORD}

# Memory Management (same as primary)
maxmemory 512mb
maxmemory-policy allkeys-lru

# Persistence (DISABLED - cache only)
save ""
appendonly no

# Replication (Replica)
# Connect to primary for replication
replicaof ${PRIMARY_HOST} 6379
replica-serve-stale-data yes
replica-read-only yes
replica-priority 100

# Announce self to Sentinel
replica-announce-ip ${REPLICA_HOST}
replica-announce-port 6379

# Slow log
slowlog-log-slower-than 5000
slowlog-max-len 128

# Logging
loglevel notice
logfile ""

# Advanced
hz 10
dynamic-hz yes

# Client output buffer limits
client-output-buffer-limit normal 0 0 0
client-output-buffer-limit replica 256mb 64mb 60
client-output-buffer-limit pubsub 32mb 8mb 60

# Database
databases 1

# Lazy freeing
lazyfree-lazy-eviction yes
lazyfree-lazy-expire yes
lazyfree-lazy-server-del yes
replica-lazy-flush yes

# Threading
io-threads 2
io-threads-do-reads yes

# Replication optimization
repl-diskless-sync yes
repl-diskless-sync-delay 5
repl-diskless-load on-empty-db
repl-disable-tcp-nodelay no
